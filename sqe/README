It seems np.correlate mode = 'full' works better than mode = 'same'
